import{a as Fe,b as mt,c as pt,d as ut,e as ft,f as bt}from"./chunk-YDXDEPWG.js";import{a as nt,b as at,d as st,e as lt,f as dt,g as ct}from"./chunk-2KCCNLLX.js";import{a as Je}from"./chunk-LPADCKLS.js";import{a as Ue,c as Pe}from"./chunk-UMI7HSWI.js";import{a as We,b as Xe,c as Ye,d as Ze}from"./chunk-BV6TYCXW.js";import{b as $}from"./chunk-GBBGNRVD.js";import{a as He}from"./chunk-YCUPTL4E.js";import"./chunk-PWZPQ65G.js";import{b as ye}from"./chunk-YHFRRQDT.js";import"./chunk-3YNCASRX.js";import"./chunk-LQNDUZZ3.js";import{a as rt,b as ot}from"./chunk-WSR74K22.js";import{a as we,b as Se,d as tt,e as it}from"./chunk-TNBXB3OF.js";import{a as Ge,i as Qe,j as qe}from"./chunk-NQJA3X5V.js";import"./chunk-6EXTZTDU.js";import{A as oe,B as ne,b as Y,d as et,f as Z,g as ee,l as te,o as ie,r as re,z as Q}from"./chunk-CDNC7OL4.js";import{a as U,b as Ke,c as P,e as G}from"./chunk-KJHWZUJ7.js";import{b as V,c as B}from"./chunk-52K55OIP.js";import"./chunk-VLIU3RIG.js";import"./chunk-IBS3LV7I.js";import"./chunk-DMLXHO7N.js";import{f as Ne,g as $e,h as me,i as Ce}from"./chunk-AUOWE7UJ.js";import{c as Oe}from"./chunk-JGE5CCOK.js";import{h as N,r as xe}from"./chunk-YBXV6SIX.js";import{$b as v,Bb as d,Bc as ge,Db as he,F as De,H as Ee,Hb as ce,Ib as F,J as I,Ja as fe,Lb as E,Mb as A,Nb as s,Ob as c,Oc as M,Pb as u,Tb as R,X as D,Y as z,Zb as h,_ as S,ab as be,ca as Ae,db as n,dc as q,eb as _,ec as H,f as W,fc as K,g as ue,gc as J,ha as Re,hc as m,ia as X,ic as _e,jc as C,n as Le,na as y,o as de,rc as w,s as g,sc as je,tc as k,vc as ze,ya as f,za as b,zb as O,zc as ve}from"./chunk-PRGEIZ6M.js";import{a as Te}from"./chunk-7EPSDV5K.js";var pe=class{constructor(l){this.id=l.id||null,this.title=l.title,this.description=l.description||null,this.icon=l.icon||null,this.lastActivity=l.lastActivity||null,this.lists=[],this.labels=[],this.members=[],l.lists&&(this.lists=l.lists.map(e=>e instanceof T?e:new T(e))),l.labels&&(this.labels=l.labels.map(e=>e instanceof ae?e:new ae(e))),l.members&&(this.members=l.members.map(e=>e instanceof ke?e:new ke(e)))}},T=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.position=l.position,this.title=l.title,this.cards=[],l.cards&&(this.cards=l.cards.map(e=>e instanceof j?e:new j(e)))}},j=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.listId=l.listId,this.position=l.position,this.title=l.title,this.description=l.description||null,this.labels=[],this.dueDate=l.dueDate||null,l.labels&&(this.labels=l.labels.map(e=>e instanceof ae?e:new ae(e)))}},ke=class{constructor(l){this.id=l.id||null,this.name=l.name,this.avatar=l.avatar||null}},ae=class{constructor(l){this.id=l.id||null,this.boardId=l.boardId,this.title=l.title}};var wt=["titleInput"],St=["titleAutosize"],kt=o=>({"pointer-events-none opacity-0":o}),It=o=>({"opacity-0":o}),ht=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._formBuilder=t,this.buttonTitle="Add a card",this.saved=new fe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){let e=this.form.get("title").value;!e||e.trim()===""||(this.saved.next(e.trim()),this.formVisible=!1,this.form.get("title").setValue(""),setTimeout(()=>{this.titleInput.nativeElement.value="",this.titleAutosize.reset()}),this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||o)(_(M),_(Q))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board-add-card"]],viewQuery:function(t,i){if(t&1&&(q(wt,5),q(St,5)),t&2){let r;H(r=K())&&(i.titleInput=r.first),H(r=K())&&(i.titleAutosize=r.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},standalone:!0,features:[w],decls:17,vars:18,consts:[["titleInput","","titleAutosize","cdkTextareaAutosize"],[1,"p-3","pt-0"],[1,"relative","flex","h-full","w-full","rounded-lg"],["mat-button","","disableRipple","",1,"absolute","inset-0","w-full","justify-start","rounded-lg",3,"click","ngClass"],[1,"icon-size-5",3,"svgIcon"],[1,"text-secondary","ml-2"],[1,"flex","w-full","flex-col","items-start",3,"ngClass","formGroup"],[1,"bg-card","flex","w-full","rounded-lg","p-5","shadow"],["cdkTextareaAutosize","",1,"w-full","text-lg","font-medium","leading-5",3,"keydown.enter","spellcheck","formControlName","placeholder"],[1,"mt-2","flex","items-center"],["mat-flat-button","",1,"h-8","min-h-8",3,"click","color","type"],["mat-icon-button","",1,"ml-1","h-8","min-h-8","w-8",3,"click","type"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,i){if(t&1){let r=R();s(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(3,"mat-icon",4),s(4,"span",5),m(5),c()(),s(6,"form",6)(7,"div",7)(8,"textarea",8,0),h("keydown.enter",function(){return f(r),b(i.save())}),m(11,"                "),c()(),s(12,"div",9)(13,"button",10),h("click",function(){return f(r),b(i.save())}),m(14," Add card "),c(),s(15,"button",11),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(16,"mat-icon",12),c()()()()()}t&2&&(he("h-13",!i.formVisible),n(2),d("ngClass",k(14,kt,i.formVisible)),n(),d("svgIcon","heroicons_outline:plus-circle"),n(2),_e(i.buttonTitle),n(),d("ngClass",k(16,It,!i.formVisible))("formGroup",i.form),n(2),d("spellcheck","off")("formControlName","title")("placeholder","Enter card title..."),n(5),d("color","primary")("type","button"),n(2),d("type","button"),n(),d("svgIcon","heroicons_solid:x-mark"))},dependencies:[G,U,P,N,B,V,oe,te,Y,Z,ee,ne,ie,re,Se,we],encapsulation:2,changeDetection:0})}}return o})();var Dt=["titleInput"],Ft=o=>({"pointer-events-none opacity-0":o}),Mt=o=>({"opacity-0":o}),_t=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._formBuilder=t,this.buttonTitle="Add a list",this.saved=new fe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){let e=this.form.get("title").value;!e||e.trim()===""||(this.saved.next(e.trim()),this.form.get("title").setValue(""),this.formVisible=!1,this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static{this.\u0275fac=function(t){return new(t||o)(_(M),_(Q))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board-add-list"]],viewQuery:function(t,i){if(t&1&&q(Dt,5),t&2){let r;H(r=K())&&(i.titleInput=r.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},standalone:!0,features:[w],decls:14,vars:18,consts:[["titleInput",""],[1,"mt-11","w-64","px-2","py-2.5"],[1,"relative","flex","h-full","w-full","overflow-hidden","rounded-xl","bg-gray-200","dark:bg-gray-700"],["mat-button","","disableRipple","",1,"absolute","inset-0","w-full","justify-start","rounded-xl","bg-transparent","px-3",3,"click","ngClass"],[1,"icon-size-5",3,"svgIcon"],[1,"text-secondary","ml-2"],[1,"flex","w-full","flex-col","items-start","p-3",3,"ngClass","formGroup"],[1,"w-full","rounded-md","border","border-gray-300","bg-white","px-3","py-2","leading-5","shadow-sm","focus:border-primary","dark:border-gray-500","dark:bg-black","dark:bg-opacity-5","dark:focus:border-primary",3,"keydown.enter","autocomplete","formControlName","placeholder"],[1,"mt-2","flex","items-center"],["mat-flat-button","",1,"h-8","min-h-8",3,"click","color","type"],["mat-icon-button","",1,"ml-1","h-8","min-h-8","w-8",3,"click","type"],[1,"icon-size-4",3,"svgIcon"]],template:function(t,i){if(t&1){let r=R();s(0,"div",1)(1,"div",2)(2,"button",3),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(3,"mat-icon",4),s(4,"span",5),m(5),c()(),s(6,"form",6)(7,"input",7,0),h("keydown.enter",function(){return f(r),b(i.save())}),c(),s(9,"div",8)(10,"button",9),h("click",function(){return f(r),b(i.save())}),m(11," Add list "),c(),s(12,"button",10),h("click",function(){return f(r),b(i.toggleFormVisibility())}),u(13,"mat-icon",11),c()()()()()}t&2&&(he("h-15",!i.formVisible),n(2),d("ngClass",k(14,Ft,i.formVisible)),n(),d("svgIcon","heroicons_outline:plus-circle"),n(2),_e(i.buttonTitle),n(),d("ngClass",k(16,Mt,!i.formVisible))("formGroup",i.form),n(),d("autocomplete","off")("formControlName","title")("placeholder","Enter list title..."),n(3),d("color","primary")("type","button"),n(2),d("type","button"),n(),d("svgIcon","heroicons_solid:x-mark"))},dependencies:[G,U,P,N,B,V,oe,te,Y,Z,ee,ne,ie,re],encapsulation:2,changeDetection:0})}}return o})();var L=(()=>{class o{constructor(e){this._httpClient=e,this._board=new ue(null),this._boards=new ue(null),this._card=new ue(null)}get board$(){return this._board.asObservable()}get boards$(){return this._boards.asObservable()}get card$(){return this._card.asObservable()}getBoards(){return this._httpClient.get("api/apps/scrumboard/boards").pipe(g(e=>e.map(t=>new pe(t))),S(e=>this._boards.next(e)))}getBoard(e){return this._httpClient.get("api/apps/scrumboard/board",{params:{id:e}}).pipe(g(t=>new pe(t)),S(t=>this._board.next(t)))}createBoard(e){return this.boards$.pipe(I(1),D(t=>this._httpClient.put("api/apps/scrumboard/board",{board:e}).pipe(g(i=>(this._boards.next([...t,i]),i)))))}updateBoard(e,t){return this.boards$.pipe(I(1),D(i=>this._httpClient.patch("api/apps/scrumboard/board",{id:e,board:t}).pipe(g(r=>{let a=i.findIndex(p=>p.id===e);return i[a]=r,this._boards.next(i),r}))))}deleteBoard(e){return this.boards$.pipe(I(1),D(t=>this._httpClient.delete("api/apps/scrumboard/board",{params:{id:e}}).pipe(g(i=>{let r=t.findIndex(a=>a.id===e);return t.splice(r,1),this._boards.next(t),this._board.next(null),this._card.next(null),i}))))}createList(e){return this._httpClient.post("api/apps/scrumboard/board/list",{list:e}).pipe(g(t=>new T(t)),S(t=>{let i=this._board.value;i.lists=[...i.lists,t],i.lists.sort((r,a)=>r.position-a.position),this._board.next(i)}))}updateList(e){return this._httpClient.patch("api/apps/scrumboard/board/list",{list:e}).pipe(g(t=>new T(t)),S(t=>{let i=this._board.value,r=i.lists.findIndex(a=>a.id===e.id);i.lists[r]=t,i.lists.sort((a,p)=>a.position-p.position),this._board.next(i)}))}updateLists(e){return this._httpClient.patch("api/apps/scrumboard/board/lists",{lists:e}).pipe(g(t=>t.map(i=>new T(i))),S(t=>{let i=this._board.value;t.forEach(r=>{let a=i.lists.findIndex(p=>p.id===r.id);i.lists[a]=r}),i.lists.sort((r,a)=>r.position-a.position),this._board.next(i)}))}deleteList(e){return this._httpClient.delete("api/apps/scrumboard/board/list",{params:{id:e}}).pipe(S(t=>{let i=this._board.value,r=i.lists.findIndex(a=>a.id===e);i.lists.splice(r,1),i.lists.sort((a,p)=>a.position-p.position),this._board.next(i)}))}getCard(e){return this._board.pipe(I(1),g(t=>{let i=t.lists.find(r=>r.cards.some(a=>a.id===e)).cards.find(r=>r.id===e);return this._card.next(i),i}),D(t=>t?Le(t):de("Could not found the card with id of "+e+"!")))}createCard(e){return this._httpClient.put("api/apps/scrumboard/board/card",{card:e}).pipe(g(t=>new j(t)),S(t=>{let i=this._board.value;return i.lists.forEach((r,a,p)=>{r.id===t.listId&&p[a].cards.push(t)}),this._board.next(i),t}))}updateCard(e,t){return this.board$.pipe(I(1),D(i=>this._httpClient.patch("api/apps/scrumboard/board/card",{id:e,card:t}).pipe(g(r=>(i.lists.forEach(a=>{a.cards.forEach((p,x,le)=>{p.id===e&&(le[x]=r)})}),this._board.next(i),this._card.next(r),r)))))}updateCards(e){return this._httpClient.patch("api/apps/scrumboard/board/cards",{cards:e}).pipe(g(t=>t.map(i=>new j(i))),S(t=>{let i=this._board.value;t.forEach(r=>{let a=i.lists.findIndex(x=>x.id===r.listId),p=i.lists[a].cards.findIndex(x=>x.id===r.id);i.lists[a].cards[p]=r,i.lists[a].cards.sort((x,le)=>x.position-le.position)}),this._board.next(i)}))}deleteCard(e){return this.board$.pipe(I(1),D(t=>this._httpClient.delete("api/apps/scrumboard/board/card",{params:{id:e}}).pipe(g(i=>(t.lists.forEach(r=>{r.cards.forEach((a,p,x)=>{a.id===e&&x.splice(p,1)})}),this._board.next(t),this._card.next(null),i)))))}createLabel(e){return this.board$.pipe(I(1),D(t=>this._httpClient.post("api/apps/scrumboard/board/label",{label:e}).pipe(g(i=>(t.labels=[...t.labels,i],this._board.next(t),i)))))}updateLabel(e,t){return this.board$.pipe(I(1),D(i=>this._httpClient.patch("api/apps/scrumboard/board/label",{id:e,label:t}).pipe(g(r=>{let a=i.labels.findIndex(p=>p.id===e);return i.labels[a]=r,this._board.next(i),r}))))}deleteLabel(e){return this.board$.pipe(I(1),D(t=>this._httpClient.delete("api/apps/scrumboard/board/label",{params:{id:e}}).pipe(g(i=>{let r=t.labels.findIndex(a=>a.id===e);return t.labels.splice(r,1),i&&t.lists.forEach(a=>{a.cards.forEach(p=>{let x=p.labels.findIndex(le=>le.id===e);x>-1&&p.labels.splice(x,1)})}),this._board.next(t),i}))))}search(e){return this._httpClient.get("api/apps/scrumboard/board/search",{params:{query:e}})}static{this.\u0275fac=function(t){return new(t||o)(Re(Oe))}}static{this.\u0275prov=Ae({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Vt=()=>[".."],Bt=o=>["card",o],Tt=o=>({"text-red-600":o});function Lt(o,l){if(o&1&&(s(0,"div",27),u(1,"img",30),c()),o&2){let e=v().$implicit;n(),d("src",e.coverImage,be)}}function Et(o,l){if(o&1&&(s(0,"div",32),m(1),c()),o&2){let e=l.$implicit;n(),C(" ",e.title," ")}}function At(o,l){if(o&1&&(s(0,"div")(1,"div",31),E(2,Et,2,1,"div",32,ce().trackByFn,!0),c()()),o&2){let e=v().$implicit;n(2),A(e.labels)}}function Rt(o,l){if(o&1&&(s(0,"div",29),u(1,"mat-icon",33),s(2,"div",21),m(3),ve(4,"date"),c()()),o&2){let e=v().$implicit,t=v(2);d("ngClass",k(6,Tt,t.isOverdue(e.dueDate))),n(),d("svgIcon","heroicons_outline:clock"),n(2),C(" ",ge(4,3,e.dueDate,"longDate")," ")}}function jt(o,l){if(o&1&&(s(0,"a",26),O(1,Lt,2,1,"div",27),s(2,"div",28),m(3),c(),O(4,At,4,0,"div")(5,Rt,5,8,"div",29),c()),o&2){let e=l.$implicit;d("routerLink",k(5,Bt,e.id)),n(),F(e.coverImage?1:-1),n(2),C(" ",e.title," "),n(),F(e.labels.length?4:-1),n(),F(e.dueDate?5:-1)}}function zt(o,l){if(o&1){let e=R();s(0,"div",14)(1,"div",17)(2,"div",18)(3,"input",19,0),h("focusout",function(i){let r=f(e).$implicit,a=v();return b(a.updateListTitle(i,r))})("keydown.enter",function(){f(e);let i=J(4);return b(i.blur())}),c()(),s(5,"div",20),m(6),c(),s(7,"div",21)(8,"button",22),u(9,"mat-icon",8),c(),s(10,"mat-menu",null,1)(12,"button",23),h("click",function(){f(e);let i=J(4),r=v();return b(r.renameList(i))}),u(13,"mat-icon",8),m(14," Rename list "),c(),s(15,"button",23),h("click",function(){let i=f(e).$implicit,r=v();return b(r.deleteList(i.id))}),u(16,"mat-icon",8),m(17," Delete list "),c()()()(),s(18,"div",24)(19,"div",25),h("cdkDropListDropped",function(i){f(e);let r=v();return b(r.cardDropped(i))}),E(20,jt,6,7,"a",26,ce().trackByFn,!0),c(),s(22,"scrumboard-board-add-card",15),h("saved",function(i){let r=f(e).$implicit,a=v();return b(a.addCard(r,i))}),c()()()}if(o&2){let e=l.$implicit,t=J(11);d("cdkDragLockAxis","x"),n(3),d("spellcheck","false")("value",e.title),n(3),C(" ",e.cards.length," "),n(2),d("matMenuTriggerFor",t),n(),d("svgIcon","heroicons_solid:ellipsis-vertical"),n(4),d("svgIcon","heroicons_solid:pencil-square"),n(3),d("svgIcon","heroicons_solid:trash"),n(3),d("id",e.id)("cdkDropListData",e.cards),n(),A(e.cards),n(2),d("buttonTitle",e.cards.length?"Add another card":"Add a card")}}var vt=(()=>{class o{constructor(e,t,i,r){this._changeDetectorRef=e,this._formBuilder=t,this._fuseConfirmationService=i,this._scrumboardService=r,this._positionStep=65536,this._maxListCount=200,this._maxPosition=this._positionStep*500,this._unsubscribeAll=new W}ngOnInit(){this.listTitleForm=this._formBuilder.group({title:[""]}),this._scrumboardService.board$.pipe(z(this._unsubscribeAll)).subscribe(e=>{this.board=Te({},e),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}renameList(e){setTimeout(()=>{e.focus()})}addList(e){if(this.board.lists.length>=this._maxListCount)return;let t=new T({boardId:this.board.id,position:this.board.lists.length?this.board.lists[this.board.lists.length-1].position+this._positionStep:this._positionStep,title:e});this._scrumboardService.createList(t).subscribe()}updateListTitle(e,t){let i=e.target,r=i.value;if(!r||r.trim()===""){i.value=t.title;return}t.title=i.value=r.trim(),this._scrumboardService.updateList(t).subscribe()}deleteList(e){this._fuseConfirmationService.open({title:"Delete list",message:"Are you sure you want to delete this list and its cards? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{i==="confirmed"&&this._scrumboardService.deleteList(e).subscribe()})}addCard(e,t){let i=new j({boardId:this.board.id,listId:e.id,position:e.cards.length?e.cards[e.cards.length-1].position+this._positionStep:this._positionStep,title:t});this._scrumboardService.createCard(i).subscribe()}listDropped(e){Fe(e.container.data,e.previousIndex,e.currentIndex);let t=this._calculatePositions(e);this._scrumboardService.updateLists(t).subscribe()}cardDropped(e){e.previousContainer===e.container?Fe(e.container.data,e.previousIndex,e.currentIndex):(mt(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),e.container.data[e.currentIndex].listId=e.container.id);let t=this._calculatePositions(e);this._scrumboardService.updateCards(t).subscribe()}isOverdue(e){return $.fromISO(e).startOf("day")<$.now().startOf("day")}trackByFn(e,t){return t.id||e}_calculatePositions(e){let t=e.container.data,i=t[e.currentIndex],r=t[e.currentIndex-1]||null,a=t[e.currentIndex+1]||null;return r?a?i.position=(r.position+a.position)/2:i.position=r.position+this._positionStep:a?i.position=a.position/2:i.position=this._positionStep,!Number.isInteger(i.position)||i.position>=this._maxPosition?(t=t.map((p,x)=>(p.position=(x+1)*this._positionStep,p)),t):[i]}static{this.\u0275fac=function(t){return new(t||o)(_(M),_(Q),_(Je),_(L))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-board"]],standalone:!0,features:[w],decls:22,vars:8,consts:[["listTitleInput",""],["listMenu","matMenu"],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","flex","flex-0","flex-col","border-b","p-6","dark:bg-transparent","sm:flex-row","sm:items-center","sm:justify-between","sm:px-10","sm:py-8"],[1,"min-w-0","flex-1"],[1,"truncate","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:text-4xl"],[1,"mt-6","flex","shrink-0","items-center","sm:ml-4","sm:mt-0"],["mat-stroked-button","",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-stroked-button","",1,"ml-3"],["cdkScrollable","",1,"flex-auto","overflow-y-auto","p-6","sm:p-8","sm:pt-4"],["cdkDropList","",1,"flex",3,"cdkDropListDropped","cdkDropListData","cdkDropListOrientation"],["cdkDropListGroup","",1,"flex","items-start"],["cdkDrag","",1,"bg-default","w-72","flex-0","rounded-2xl","p-2",3,"cdkDragLockAxis"],[3,"saved","buttonTitle"],[1,"pointer-events-none","invisible","absolute","h-0","w-0","opacity-0"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","w-full","cursor-text","items-center","rounded-md","border","border-transparent","px-3","py-2","focus-within:border-primary","focus-within:bg-white","focus-within:shadow-sm","dark:focus-within:bg-gray-900"],[1,"w-full","bg-transparent","font-medium","leading-5",3,"focusout","keydown.enter","spellcheck","value"],[1,"text-secondary","ml-4","flex","min-w-6","items-center","justify-center","rounded-full","bg-gray-300","text-sm","font-semibold","leading-6","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"h-8","min-h-8","w-8",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:border","dark:bg-transparent"],["cdkDropList","",1,"p-3","pb-0",3,"cdkDropListDropped","id","cdkDropListData"],["cdkDrag","",1,"bg-card","mb-3","flex","flex-col","items-start","space-y-3","overflow-hidden","rounded-lg","p-5","shadow",3,"routerLink"],[1,"-mx-5","-mt-5","mb-2"],[1,"text-lg","font-medium","leading-5"],[1,"text-secondary","flex","items-center","rounded","text-sm","font-medium","leading-5",3,"ngClass"],[1,"w-full","object-cover",3,"src"],[1,"-mx-1","-mb-2","flex","flex-wrap"],[1,"mx-1","mb-2","rounded-full","bg-gray-100","px-3","py-0.5","text-sm","font-medium","text-gray-500","dark:bg-gray-700","dark:text-gray-300"],[1,"text-current","icon-size-4",3,"svgIcon"]],template:function(t,i){t&1&&(s(0,"div",2)(1,"div",3)(2,"div",4)(3,"h2",5),m(4),c()(),s(5,"div",6)(6,"a",7),u(7,"mat-icon",8),s(8,"span",9),m(9,"Boards"),c()(),s(10,"button",10),u(11,"mat-icon",8),s(12,"span",9),m(13,"Settings"),c()()()(),s(14,"div",11)(15,"div",12),h("cdkDropListDropped",function(a){return i.listDropped(a)}),s(16,"div",13),E(17,zt,23,11,"div",14,i.trackByFn,!0),s(19,"scrumboard-board-add-list",15),h("saved",function(a){return i.addList(a)}),c()()()()(),s(20,"div",16),u(21,"router-outlet"),c()),t&2&&(n(4),C(" ",i.board.title," "),n(2),d("routerLink",je(7,Vt)),n(),d("svgIcon","heroicons_solid:view-columns"),n(4),d("svgIcon","heroicons_solid:cog-8-tooth"),n(4),d("cdkDropListData",i.board.lists)("cdkDropListOrientation","horizontal"),n(2),A(i.board.lists),n(2),d("buttonTitle",i.board.lists.length?"Add another list":"Add a list"))},dependencies:[G,Ke,U,P,Ce,B,V,ye,bt,ft,ut,pt,Ze,Xe,We,Ye,N,ht,_t,$e,xe],styles:[`.cdk-drag-preview{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.cdk-drag-placeholder{opacity:0}.cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging div:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}
`],encapsulation:2,changeDetection:0})}}return o})();var Ot=o=>[o];function Nt(o,l){if(o&1&&u(0,"img",16),o&2){let e=l.$implicit;d("src",e.avatar,be)}}function $t(o,l){if(o&1&&(s(0,"div",17)(1,"div",18),m(2),c()()),o&2){let e=v(2).$implicit;n(2),C(" +",e.members.slice(5).length," ")}}function Ut(o,l){if(o&1&&(u(0,"div",14),s(1,"div",15),E(2,Nt,1,1,"img",16,ce().trackByFn,!0),O(4,$t,3,1,"div",17),c()),o&2){let e=v().$implicit;n(2),A(e.members.slice(0,5)),n(2),F(e.members.length>5?4:-1)}}function Pt(o,l){if(o&1&&(s(0,"a",4)(1,"div",7),u(2,"mat-icon",8),c(),s(3,"div",9),m(4),c(),s(5,"div",10),m(6),c(),O(7,Ut,5,1),s(8,"div",11)(9,"div",12),m(10,"Edited:"),c(),s(11,"div",13),m(12),c()()()),o&2){let e=l.$implicit,t=v();d("routerLink",k(6,Ot,e.id)),n(2),d("svgIcon",e.icon),n(2),C(" ",e.title," "),n(2),C(" ",e.description," "),n(),F(e.members!=null&&e.members.length?7:-1),n(5),C(" ",t.formatDateAsRelative(e.lastActivity)," ")}}var gt=(()=>{class o{constructor(e,t){this._changeDetectorRef=e,this._scrumboardService=t,this._unsubscribeAll=new W}ngOnInit(){this._scrumboardService.boards$.pipe(z(this._unsubscribeAll)).subscribe(e=>{this.boards=e,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}formatDateAsRelative(e){return $.fromISO(e).toRelative()}trackByFn(e,t){return t.id||e}static{this.\u0275fac=function(t){return new(t||o)(_(M),_(L))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-boards"]],standalone:!0,features:[w],decls:9,vars:1,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-y-auto"],[1,"flex","flex-auto","flex-col","items-center","p-6","sm:p-10"],[1,"mt-4","text-3xl","font-extrabold","leading-7","tracking-tight","sm:leading-10","md:mt-24","md:text-6xl"],[1,"mt-8","grid","grid-cols-1","gap-4","sm:grid-cols-2","md:mt-16","lg:grid-cols-4"],[1,"bg-card","flex","w-56","flex-col","items-start","rounded-lg","p-6","shadow","transition-shadow","duration-150","ease-in-out","hover:shadow-xl",3,"routerLink"],[1,"flex","w-56","cursor-pointer","flex-col","items-center","justify-center","rounded-lg","border-2","border-dashed","border-gray-300","transition-colors","duration-150","ease-in-out","hover:bg-hover"],[1,"text-hint","icon-size-12",3,"svgIcon"],[1,"flex","items-center","justify-center","rounded-full","bg-primary-50","p-4","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"text-secondary","mt-0.5","line-clamp-2"],[1,"font-md","mt-4","flex","items-center","text-md"],[1,"text-secondary"],[1,"ml-1"],[1,"mt-6","h-1","w-12","border-t-2"],[1,"mt-6","flex","items-center","-space-x-1.5"],["alt","Member avatar",1,"ring-bg-card","h-8","w-8","flex-0","rounded-full","object-cover","ring","ring-offset-1","ring-offset-transparent",3,"src"],[1,"ring-bg-card","flex","h-8","w-8","flex-0","items-center","justify-center","rounded-full","bg-gray-200","text-gray-500","ring","ring-offset-1","ring-offset-transparent"],[1,"text-md","font-semibold"]],template:function(t,i){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2),m(3," Scrumboard Boards "),c(),s(4,"div",3),E(5,Pt,13,8,"a",4,i.trackByFn,!0),s(7,"div",5),u(8,"mat-icon",6),c()()()()),t&2&&(n(5),A(i.boards),n(3),d("svgIcon","heroicons_outline:plus"))},dependencies:[ye,Ce,B,V],encapsulation:2,changeDetection:0})}}return o})();var Qt=["labelInput"],qt=(o,l,e)=>({"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-300":o,"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":l,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e});function Ht(o,l){if(o&1&&(m(0),ve(1,"date")),o&2){let e=v();C(" ",ge(1,1,e.card.dueDate,"longDate")," ")}}function Kt(o,l){o&1&&m(0," Not set ")}function Jt(o,l){if(o&1){let e=R();s(0,"mat-checkbox",25),h("change",function(i){let r=f(e).$implicit,a=v();return b(a.toggleProductTag(r,i))}),m(1),c()}if(o&2){let e=l.$implicit,t=v();d("color","primary")("checked",t.hasLabel(e)),n(),C(" ",e.title," ")}}var xt=(()=>{class o{constructor(e,t,i,r){this.matDialogRef=e,this._changeDetectorRef=t,this._formBuilder=i,this._scrumboardService=r,this._unsubscribeAll=new W}ngOnInit(){this._scrumboardService.board$.pipe(z(this._unsubscribeAll)).subscribe(e=>{this.board=e,this.labels=this.filteredLabels=e.labels}),this._scrumboardService.card$.pipe(z(this._unsubscribeAll)).subscribe(e=>{this.card=e}),this.cardForm=this._formBuilder.group({id:[""],title:["",et.required],description:[""],labels:[[]],dueDate:[null]}),this.cardForm.setValue({id:this.card.id,title:this.card.title,description:this.card.description,labels:this.card.labels,dueDate:this.card.dueDate}),this.cardForm.valueChanges.pipe(S(e=>{this.card=He(this.card,e)}),Ee(300),z(this._unsubscribeAll)).subscribe(e=>{this._scrumboardService.updateCard(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}hasLabel(e){return!!this.card.labels.find(t=>t.id===e.id)}filterLabels(e){let t=e.target.value.toLowerCase();this.filteredLabels=this.labels.filter(i=>i.title.toLowerCase().includes(t))}filterLabelsInputKeyDown(e){if(e.key!=="Enter"||this.filteredLabels.length===0)return;let t=this.filteredLabels[0];this.card.labels.find(r=>r.id===t.id)?this.removeLabelFromCard(t):this.addLabelToCard(t)}toggleProductTag(e,t){t.checked?this.addLabelToCard(e):this.removeLabelFromCard(e)}addLabelToCard(e){this.card.labels.unshift(e),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}removeLabelFromCard(e){this.card.labels.splice(this.card.labels.findIndex(t=>t.id===e.id),1),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}isOverdue(e){return $.fromISO(e).startOf("day")<$.now().startOf("day")}trackByFn(e,t){return t.id||e}_readAsDataURL(e){return new Promise((t,i)=>{let r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=a=>{i(a)},r.readAsDataURL(e)})}static{this.\u0275fac=function(t){return new(t||o)(_(Ue),_(M),_(Q),_(L))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-card-details"]],viewQuery:function(t,i){if(t&1&&q(Qt,5),t&2){let r;H(r=K())&&(i.labelInput=r.first)}},standalone:!0,features:[w],decls:45,vars:25,consts:[["dueDatePicker",""],[1,"-m-6","flex","max-h-160","flex-auto","flex-col","overflow-y-auto","md:w-160","md:min-w-160"],[1,"flex","h-16","flex-0","items-center","justify-between","bg-primary","pl-6","pr-3","text-on-primary","sm:pl-8","sm:pr-5"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"click","tabIndex"],[1,"text-current",3,"svgIcon"],[1,"flex","w-full","flex-0","flex-col","items-start","space-y-6","overflow-y-auto","p-6","sm:p-8",3,"formGroup"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","rows","cdkAutosizeMinRows"],[1,"font-medium"],[1,"relative","mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"click","ngClass"],[1,"text-current","icon-size-5",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","pointer-events-none","invisible","absolute","inset-0","-mt-2.5","opacity-0",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",3,"color"],[1,"w-full"],[1,"mt-1","overflow-hidden","rounded-md","border","border-gray-300","shadow-sm"],[1,"mx-3","my-2","flex","items-center"],[1,"flex","min-w-0","flex-auto","items-center"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Enter label name",1,"ml-2","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],[1,"max-h-40","overflow-y-auto","border-t","leading-none"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"color","checked"],[1,"flex","h-10","min-h-10","items-center","pl-1","pr-4",3,"change","color","checked"]],template:function(t,i){if(t&1){let r=R();s(0,"div",1)(1,"div",2)(2,"div",3),m(3,"Card"),c(),s(4,"button",4),h("click",function(){return f(r),b(i.matDialogRef.close())}),u(5,"mat-icon",5),c()(),s(6,"form",6)(7,"mat-form-field",7)(8,"mat-label"),m(9,"Title"),c(),s(10,"textarea",8),m(11,"            "),c()(),s(12,"mat-form-field",7)(13,"mat-label"),m(14,"Description"),c(),s(15,"textarea",8),m(16,"            "),c()(),s(17,"div")(18,"div",9),m(19,"Due date"),c(),s(20,"div",10),h("click",function(){f(r);let p=J(28);return b(p.open())}),u(21,"mat-icon",11),s(22,"span",12),O(23,Ht,2,4)(24,Kt,1,0),c(),s(25,"mat-form-field",13),u(26,"input",14),s(27,"mat-datepicker",null,0)(29,"mat-datepicker-actions")(30,"button",15),h("click",function(){return f(r),b(i.cardForm.get("dueDate").setValue(null))}),m(31," Clear "),c(),s(32,"button",16),m(33," Select "),c()()()()()(),s(34,"div",17)(35,"div",9),m(36,"Labels"),c(),s(37,"div",18)(38,"div",19)(39,"div",20),u(40,"mat-icon",21),s(41,"input",22),h("input",function(p){return f(r),b(i.filterLabels(p))})("keydown",function(p){return f(r),b(i.filterLabelsInputKeyDown(p))}),c()()(),s(42,"div",23),E(43,Jt,2,3,"mat-checkbox",24,i.trackByFn,!0),c()()()()()}if(t&2){let r=J(28);n(4),d("tabIndex",-1),n(),d("svgIcon","heroicons_outline:x-mark"),n(),d("formGroup",i.cardForm),n(),d("subscriptSizing","dynamic"),n(3),d("formControlName","title")("rows",1)("cdkAutosizeMinRows",1),n(2),d("subscriptSizing","dynamic"),n(3),d("formControlName","description")("rows",1)("cdkAutosizeMinRows",1),n(5),d("ngClass",ze(21,qt,!i.card.dueDate,i.card.dueDate&&!i.isOverdue(i.card.dueDate),i.card.dueDate&&i.isOverdue(i.card.dueDate))),n(),d("svgIcon","heroicons_solid:calendar"),n(2),F(i.card.dueDate?23:-1),n(),F(i.card.dueDate?-1:24),n(),d("subscriptSizing","dynamic"),n(),d("formControlName","dueDate")("matDatepicker",r),n(6),d("color","primary"),n(8),d("svgIcon","heroicons_solid:magnifying-glass"),n(),d("maxLength",50),n(2),A(i.filteredLabels)}},dependencies:[G,U,P,B,V,oe,te,Y,Z,ee,ne,ie,re,qe,Qe,Ge,it,tt,we,Se,N,ct,nt,at,dt,lt,st,ot,rt,xe],encapsulation:2,changeDetection:0})}}return o})();var Ct=(()=>{class o{constructor(e,t,i){this._activatedRoute=e,this._matDialog=t,this._router=i}ngOnInit(){this._matDialog.open(xt,{autoFocus:!1}).afterClosed().subscribe(()=>{this._router.navigate(["./../.."],{relativeTo:this._activatedRoute})})}static{this.\u0275fac=function(t){return new(t||o)(_(Ne),_(Pe),_(me))}}static{this.\u0275cmp=y({type:o,selectors:[["scrumboard-card"]],standalone:!0,features:[w],decls:1,vars:0,template:function(t,i){t&1&&m(0,`SCRUMBOARD -> BOARDS -> LIST -> CARD
`)},encapsulation:2,changeDetection:0})}}return o})();var Wt=(o,l)=>{let e=X(L),t=X(me);return e.getBoard(o.paramMap.get("boardId")).pipe(De(i=>{console.error(i);let r=l.url.split("/").slice(0,-1).join("/");return t.navigateByUrl(r),de(i)}))},Xt=(o,l)=>{let e=X(L),t=X(me);return e.getCard(o.paramMap.get("cardId")).pipe(De(i=>{console.error(i);let r=l.url.split("/").slice(0,-1).join("/");return t.navigateByUrl(r),de(i)}))},yr=[{path:"",component:gt,resolve:{boards:()=>X(L).getBoards()}},{path:":boardId",component:vt,resolve:{board:Wt},children:[{path:"card/:cardId",component:Ct,resolve:{card:Xt}}]}];export{yr as default};
