import{a as xt,c as Tt,d as yt,f as bt,g as wt}from"./chunk-OZNGOC5G.js";import{a as Ct}from"./chunk-T2PL5IIJ.js";import{a as _t,b as kt,d as gt,e as ft,f as ht,g as vt}from"./chunk-SMPCWE35.js";import{a as mt,b as pt,c as dt,d as ut}from"./chunk-W7CNA4V5.js";import{a as ze}from"./chunk-6NIFNVKK.js";import{a as je}from"./chunk-4ZGOATSA.js";import"./chunk-K6SJV66T.js";import{a as Be,b as Ne}from"./chunk-JIIP3X5D.js";import{a as rt,b as st}from"./chunk-H6DC5F6O.js";import{a as Qe,b as Ke,c as qe,d as He}from"./chunk-6GRHLUW6.js";import{c as $e}from"./chunk-MFWW5XDS.js";import{b as ce}from"./chunk-GBBGNRVD.js";import{a as Pe}from"./chunk-YCUPTL4E.js";import{f as Ee}from"./chunk-DCIWF3NK.js";import"./chunk-N64NHRQD.js";import{b as Fe}from"./chunk-N34H76JM.js";import"./chunk-WCPJYO2Z.js";import{a as lt,b as ct}from"./chunk-AOYF6QNZ.js";import"./chunk-XKTUJYVS.js";import{a as it,b as nt,d as at,e as ot}from"./chunk-BNZ6GVUN.js";import{a as Re,e as Le,i as Ve,j as Ae}from"./chunk-BVYLKFEF.js";import"./chunk-PPHX6Q7S.js";import{A as et,B as tt,b as Ue,f as Ge,g as We,l as Xe,o as Ye,r as Je,z as Ze}from"./chunk-EMGI2SSV.js";import{a as ie,c as ne,d as Oe,e as ae}from"./chunk-DPACH7O6.js";import{b as oe,c as re}from"./chunk-IIOR2V55.js";import{D as Ie,E as Me}from"./chunk-SFWQ4JHW.js";import"./chunk-DITXZIYA.js";import"./chunk-PTSJDPUO.js";import"./chunk-G5ULN3RC.js";import{d as Se,f as Z,g as ee,h as Q,i as te}from"./chunk-HZDJ65MY.js";import{c as De}from"./chunk-OAD3FQTP.js";import{d as be,h as Y,p as we,r as J}from"./chunk-MFIY2XVS.js";import{$b as _,Ac as xe,Bb as l,Bc as W,Cc as Te,D as S,Db as ve,Ec as ye,F as _e,H as le,Hb as L,Ib as u,J as T,Lb as V,Mb as A,Nb as o,Ob as s,Oc as X,Pb as m,Tb as b,X as y,Y as x,Zb as f,_ as E,ca as ke,db as a,dc as P,eb as h,ec as O,f as H,fc as j,g as U,gc as I,ha as ge,hc as p,ia as K,ic as $,jb as fe,jc as M,n as de,na as R,o as G,pb as he,rc as B,s as D,sc as Ce,tc as N,vc as q,ya as k,z as ue,za as g,zb as v,zc as z}from"./chunk-ULGM77ZI.js";import"./chunk-7EPSDV5K.js";var F=(()=>{class t{constructor(e){this._httpClient=e,this._tags=new U(null),this._task=new U(null),this._tasks=new U(null)}get tags$(){return this._tags.asObservable()}get task$(){return this._task.asObservable()}get tasks$(){return this._tasks.asObservable()}getTags(){return this._httpClient.get("api/apps/tasks/tags").pipe(E(e=>{this._tags.next(e)}))}createTag(e){return this.tags$.pipe(T(1),y(n=>this._httpClient.post("api/apps/tasks/tag",{tag:e}).pipe(D(i=>(this._tags.next([...n,i]),i)))))}updateTag(e,n){return this.tags$.pipe(T(1),y(i=>this._httpClient.patch("api/apps/tasks/tag",{id:e,tag:n}).pipe(D(r=>{let d=i.findIndex(C=>C.id===e);return i[d]=r,this._tags.next(i),r}))))}deleteTag(e){return this.tags$.pipe(T(1),y(n=>this._httpClient.delete("api/apps/tasks/tag",{params:{id:e}}).pipe(D(i=>{let r=n.findIndex(d=>d.id===e);return n.splice(r,1),this._tags.next(n),i}),S(i=>i),y(i=>this.tasks$.pipe(T(1),D(r=>(r.forEach(d=>{let C=d.tags.findIndex(w=>w===e);C>-1&&d.tags.splice(C,1)}),i)))))))}getTasks(){return this._httpClient.get("api/apps/tasks/all").pipe(E(e=>{this._tasks.next(e)}))}updateTasksOrders(e){return this._httpClient.patch("api/apps/tasks/order",{tasks:e})}searchTasks(e){return this._httpClient.get("api/apps/tasks/search",{params:{query:e}})}getTaskById(e){return this._tasks.pipe(T(1),D(n=>{let i=n.find(r=>r.id===e)||null;return this._task.next(i),i}),y(n=>n?de(n):G("Could not found task with id of "+e+"!")))}createTask(e){return this.tasks$.pipe(T(1),y(n=>this._httpClient.post("api/apps/tasks/task",{type:e}).pipe(D(i=>(this._tasks.next([i,...n]),i)))))}updateTask(e,n){return this.tasks$.pipe(T(1),y(i=>this._httpClient.patch("api/apps/tasks/task",{id:e,task:n}).pipe(D(r=>{let d=i.findIndex(C=>C.id===e);return i[d]=r,this._tasks.next(i),r}),y(r=>this.task$.pipe(T(1),S(d=>d&&d.id===e),E(()=>(this._task.next(r),r)))))))}deleteTask(e){return this.tasks$.pipe(T(1),y(n=>this._httpClient.delete("api/apps/tasks/task",{params:{id:e}}).pipe(D(i=>{let r=n.findIndex(d=>d.id===e);return n.splice(r,1),this._tasks.next(n),i}))))}static{this.\u0275fac=function(n){return new(n||t)(ge(De))}}static{this.\u0275prov=ke({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var At=["matDrawer"],Pt=(t,c,e)=>({"h-12 bg-gray-50 text-lg font-semibold dark:bg-transparent":t,"h-16":c,"text-hint":e}),Ot=t=>[t];function jt(t,c){t&1&&(o(0,"span"),p(1,"All tasks completed!"),s())}function $t(t,c){if(t&1&&(o(0,"span"),p(1),s()),t&2){let e=_();a(),M("",e.tasksCount.incomplete," remaining tasks")}}function Bt(t,c){t&1&&m(0,"div",30)}function Nt(t,c){t&1&&m(0,"div",21)}function zt(t,c){t&1&&m(0,"mat-icon",32),t&2&&l("svgIcon","heroicons_outline:check-circle")}function Qt(t,c){t&1&&m(0,"mat-icon",33),t&2&&l("svgIcon","heroicons_outline:check-circle")}function Kt(t,c){if(t&1){let e=b();o(0,"button",31),f("click",function(){k(e);let i=_().$implicit,r=_(2);return g(r.toggleCompleted(i))}),v(1,zt,1,1,"mat-icon",32)(2,Qt,1,1,"mat-icon",33),s()}if(t&2){let e=_().$implicit;a(),u(e.completed?1:-1),a(),u(e.completed?-1:2)}}function qt(t,c){if(t&1&&(o(0,"span"),p(1),s()),t&2){let e=_().$implicit;a(),$(e.title)}}function Ht(t,c){if(t&1&&(o(0,"span",27),p(1),z(2,"titlecase"),s()),t&2){let e=_().$implicit;a(),M("",xe(2,1,e.type)," title")}}function Ut(t,c){t&1&&m(0,"mat-icon",34),t&2&&l("svgIcon","heroicons_mini:arrow-long-down")("title","Low")}function Gt(t,c){t&1&&m(0,"mat-icon",35),t&2&&l("svgIcon","heroicons_mini:arrow-long-up")("title","High")}function Wt(t,c){if(t&1&&(o(0,"div",28),v(1,Ut,1,2,"mat-icon",34)(2,Gt,1,2,"mat-icon",35),s()),t&2){let e=_().$implicit;a(),u(e.priority===0?1:-1),a(),u(e.priority===2?2:-1)}}function Xt(t,c){if(t&1&&(o(0,"div",29),p(1),z(2,"date"),s()),t&2){let e=_().$implicit;a(),M(" ",W(2,1,e.dueDate,"LLL dd")," ")}}function Yt(t,c){if(t&1&&(o(0,"div",18),v(1,Bt,1,0,"div",19),o(2,"div",20),v(3,Nt,1,0,"div",21),o(4,"div",22),m(5,"mat-icon",23),s(),v(6,Kt,3,2,"button",24),o(7,"a",25)(8,"div",26),v(9,qt,2,1,"span")(10,Ht,3,3,"span",27),s(),v(11,Wt,3,2,"div",28)(12,Xt,3,4,"div",29),s()()()),t&2){let e=c.$implicit,n=c.$index,i=_(2);ve("border-t",n===0),l("id","task-"+e.id)("ngClass",q(13,Pt,e.type==="section",e.type==="task",e.completed))("cdkDragLockAxis","y"),a(3),u(i.selectedTask&&i.selectedTask.id===e.id?3:-1),a(2),l("svgIcon","heroicons_solid:bars-3"),a(),u(e.type==="task"?6:-1),a(),l("routerLink",N(17,Ot,e.id)),a(2),u(e.title?9:-1),a(),u(e.title?-1:10),a(),u(e.type==="task"?11:-1),a(),u(e.type==="task"?12:-1)}}function Jt(t,c){if(t&1){let e=b();o(0,"div",16),f("cdkDropListDropped",function(i){k(e);let r=_();return g(r.dropped(i))}),V(1,Yt,13,19,"div",17,L().trackByFn,!0),s()}if(t&2){let e=_();l("cdkDropListData",e.tasks),a(),A(e.tasks)}}function Zt(t,c){t&1&&(o(0,"div",15),m(1,"mat-icon",36),o(2,"div",37),p(3," Add a task to start planning! "),s()()),t&2&&(a(),l("svgIcon","heroicons_outline:clipboard-document-list"))}var se=(()=>{class t{constructor(e,n,i,r,d,C,w){this._activatedRoute=e,this._changeDetectorRef=n,this._document=i,this._router=r,this._tasksService=d,this._fuseMediaWatcherService=C,this._fuseNavigationService=w,this.tasksCount={completed:0,incomplete:0,total:0},this._unsubscribeAll=new H}ngOnInit(){this._tasksService.tags$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this.tasksCount.total=this.tasks.filter(n=>n.type==="task").length,this.tasksCount.completed=this.tasks.filter(n=>n.type==="task"&&n.completed).length,this.tasksCount.incomplete=this.tasksCount.total-this.tasksCount.completed,this._changeDetectorRef.markForCheck(),setTimeout(()=>{let n=this._fuseNavigationService.getComponent("mainNavigation");if(n){let i=n.navigation,r=this._fuseNavigationService.getItem("apps.tasks",i);r.subtitle=this.tasksCount.incomplete+" remaining tasks",n.refresh()}})}),this._tasksService.task$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this.selectedTask=e,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe(x(this._unsubscribeAll)).subscribe(e=>{this.drawerMode=e.matches?"side":"over",this._changeDetectorRef.markForCheck()}),ue(this._document,"keydown").pipe(x(this._unsubscribeAll),S(e=>(e.ctrlKey===!0||e.metaKey)&&(e.key==="/"||e.key==="."))).subscribe(e=>{e.key==="/"&&this.createTask("task"),e.key==="."&&this.createTask("section")})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createTask(e){this._tasksService.createTask(e).subscribe(n=>{this._router.navigate(["./",n.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}toggleCompleted(e){e.completed=!e.completed,this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}dropped(e){xt(e.container.data,e.previousIndex,e.currentIndex),this._tasksService.updateTasksOrders(e.container.data).subscribe(),this._changeDetectorRef.markForCheck()}trackByFn(e,n){return n.id||e}static{this.\u0275fac=function(n){return new(n||t)(h(Z),h(X),h(be),h(Q),h(F),h($e),h(ze))}}static{this.\u0275cmp=R({type:t,selectors:[["tasks-list"]],viewQuery:function(n,i){if(n&1&&P(At,7),n&2){let r;O(r=j())&&(i.matDrawer=r.first)}},standalone:!0,features:[B],decls:25,vars:13,consts:[["matDrawer",""],[1,"absolute","inset-0","flex","min-w-0","flex-col","overflow-hidden"],[1,"bg-card","h-full","flex-auto","dark:bg-transparent",3,"backdropClick"],[1,"w-full","dark:bg-gray-900","sm:w-128",3,"mode","opened","position","disableClose"],[1,"flex","flex-col"],[1,"flex","flex-auto","flex-col"],[1,"flex","flex-col","items-start","px-6","py-8","sm:flex-row","sm:items-center","sm:justify-between","md:px-8"],[1,"text-4xl","font-extrabold","leading-none","tracking-tight"],[1,"text-secondary","ml-0.5","font-medium"],[1,"mt-4","sm:mt-0"],["mat-flat-button","",3,"click","color","matTooltip"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-flat-button","",1,"ml-3",3,"click","color","matTooltip"],["cdkDropList","",1,"divide-y",3,"cdkDropListData"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],["cdkDropList","",1,"divide-y",3,"cdkDropListDropped","cdkDropListData"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","border-t","cdkDragLockAxis"],["cdkDrag","",1,"group","w-full","select-none","dark:hover:bg-hover","hover:bg-gray-100",3,"id","ngClass","cdkDragLockAxis"],["class","flex h-0 w-0 flex-0",4,"cdkDragPreview"],[1,"relative","flex","h-full","items-center","pl-10"],[1,"absolute","-bottom-px","-top-px","right-0","z-10","flex","w-1","flex-0","bg-primary"],["cdkDragHandle","",1,"absolute","inset-y-0","left-0","flex","w-8","cursor-move","items-center","justify-center","md:hidden","md:group-hover:flex"],[1,"text-hint","icon-size-5",3,"svgIcon"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none"],[1,"flex","h-full","min-w-0","flex-auto","items-center","pr-7",3,"routerLink"],[1,"mr-2","flex-auto","truncate"],[1,"text-hint","select-none"],[1,"mr-3","h-4","w-4"],[1,"text-secondary","whitespace-nowrap","text-sm"],[1,"flex","h-0","w-0","flex-0"],["mat-icon-button","",1,"-ml-2.5","mr-2","leading-none",3,"click"],[1,"text-primary",3,"svgIcon"],[1,"text-hint",3,"svgIcon"],[1,"text-green-600","icon-size-4","dark:text-green-400",3,"svgIcon","title"],[1,"text-red-600","icon-size-4","dark:text-red-400",3,"svgIcon","title"],[1,"icon-size-24",3,"svgIcon"],[1,"text-secondary","mt-4","text-2xl","font-semibold","tracking-tight"]],template:function(n,i){if(n&1){let r=b();o(0,"div",1)(1,"mat-drawer-container",2),f("backdropClick",function(){return k(r),g(i.onBackdropClicked())}),o(2,"mat-drawer",3,0),m(4,"router-outlet"),s(),o(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),p(10," Tasks "),s(),o(11,"div",8),v(12,jt,2,0,"span")(13,$t,2,1,"span"),s()(),o(14,"div",9)(15,"button",10),f("click",function(){return k(r),g(i.createTask("section"))}),m(16,"mat-icon",11),o(17,"span",12),p(18,"Add Section"),s()(),o(19,"button",13),f("click",function(){return k(r),g(i.createTask("task"))}),m(20,"mat-icon",11),o(21,"span",12),p(22,"Add Task"),s()()()(),v(23,Jt,3,1,"div",14)(24,Zt,4,1,"div",15),s()()()()}n&2&&(a(2),l("mode",i.drawerMode)("opened",!1)("position","end")("disableClose",!0),a(10),u(i.tasksCount.incomplete===0?12:-1),a(),u(i.tasksCount.incomplete!==0?13:-1),a(2),l("color","accent")("matTooltip","Shortcut: Ctrl + ."),a(),l("svgIcon","heroicons_outline:plus"),a(3),l("color","primary")("matTooltip","Shortcut: Ctrl + /"),a(),l("svgIcon","heroicons_outline:plus"),a(3),u(i.tasks&&i.tasks.length>0?23:24))},dependencies:[ut,pt,dt,mt,ee,ae,ie,ne,Ne,Be,re,oe,bt,yt,Y,wt,Tt,te,we,J],encapsulation:2,changeDetection:0})}}return t})();var ti=["tagsPanelOrigin"],ii=["tagsPanel"],ni=["titleField"],ai=()=>["../"],oi=(t,c,e)=>({"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":t,"bg-gray-200 text-gray-800 dark:bg-gray-500 dark:text-gray-100":c,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e}),pe=t=>({"bg-hover":t}),ri=(t,c,e)=>({"bg-gray-100 text-gray-500 dark:bg-gray-700 dark:text-gray-300":t,"bg-green-200 text-green-800 dark:bg-green-500 dark:text-green-100":c,"bg-red-200 text-red-800 dark:bg-red-500 dark:text-red-100":e});function si(t,c){t&1&&(o(0,"div",11),m(1,"mat-icon",14),o(2,"span",40),p(3,"MARK AS COMPLETE"),s()()),t&2&&(a(),l("svgIcon","heroicons_outline:check-circle"))}function li(t,c){t&1&&(o(0,"div",11),m(1,"mat-icon",41),o(2,"span",40),p(3,"MARK AS INCOMPLETE"),s()()),t&2&&(a(),l("svgIcon","heroicons_outline:check-circle"))}function ci(t,c){if(t&1&&(o(0,"div",42)(1,"span",43),p(2),s()()),t&2){let e=c.$implicit;a(2),$(e.title)}}function mi(t,c){if(t&1&&(V(0,ci,3,1,"div",42,L().trackByFn,!0),z(2,"fuseFindByKey")),t&2){let e=_();A(Te(2,0,e.task.tags,"id",e.tags))}}function pi(t,c){t&1&&(m(0,"mat-icon",44),o(1,"span",45),p(2,"Edit"),s()),t&2&&l("svgIcon","heroicons_solid:pencil-square")}function di(t,c){t&1&&(m(0,"mat-icon",44),o(1,"span",45),p(2,"Add"),s()),t&2&&l("svgIcon","heroicons_solid:plus-circle")}function ui(t,c){t&1&&m(0,"mat-icon",44),t&2&&l("svgIcon","heroicons_solid:pencil-square")}function _i(t,c){t&1&&m(0,"mat-icon",44),t&2&&l("svgIcon","heroicons_solid:check")}function ki(t,c){if(t&1){let e=b();o(0,"div",55),f("click",function(){let i=k(e).$implicit,r=_(3);return g(r.toggleTaskTag(i))}),m(1,"mat-checkbox",56),o(2,"div",57),p(3),s()()}if(t&2){let e=c.$implicit,n=_(3);a(),l("checked",n.task.tags.includes(e.id))("color","primary")("disableRipple",!0),a(2),M(" ",e.title," ")}}function gi(t,c){if(t&1&&V(0,ki,4,4,"div",54,L().trackByFn,!0),t&2){let e=_(2);A(e.filteredTags)}}function fi(t,c){if(t&1){let e=b();o(0,"div",12)(1,"mat-form-field",58)(2,"input",59),f("input",function(i){let r=k(e).$implicit,d=_(3);return g(d.updateTagTitle(r,i))}),s(),o(3,"button",60),f("click",function(){let i=k(e).$implicit,r=_(3);return g(r.deleteTag(i))}),m(4,"mat-icon",61),s()()()}if(t&2){let e=c.$implicit;a(),l("subscriptSizing","dynamic"),a(),l("value",e.title),a(2),l("svgIcon","heroicons_solid:trash")}}function hi(t,c){if(t&1&&(o(0,"div",52),V(1,fi,5,3,"div",12,L().trackByFn,!0),s()),t&2){let e=_(2);a(),A(e.filteredTags)}}function vi(t,c){if(t&1){let e=b();o(0,"div",62),f("click",function(){k(e),_();let i=I(6);return _().createTag(i.value),g(i.value="")}),m(1,"mat-icon",63),o(2,"div",64),p(3,' Create "'),o(4,"b"),p(5),s(),p(6,'" '),s()()}if(t&2){_();let e=I(6);a(),l("svgIcon","heroicons_solid:plus-circle"),a(4),$(e.value)}}function Ci(t,c){if(t&1){let e=b();o(0,"div",46)(1,"div",47)(2,"div",12),m(3,"mat-icon",44),o(4,"div",48)(5,"input",49,6),f("input",function(i){k(e);let r=_();return g(r.filterTags(i))})("keydown",function(i){k(e);let r=_();return g(r.filterTagsInputKeyDown(i))}),s()()(),o(7,"button",50),f("click",function(){k(e);let i=_();return g(i.toggleTagsEditMode())}),v(8,ui,1,1,"mat-icon",44)(9,_i,1,1,"mat-icon",44),s()(),o(10,"div",51),v(11,gi,2,0)(12,hi,3,0,"div",52)(13,vi,7,2,"div",53),s()()}if(t&2){let e=I(6),n=_();a(3),l("svgIcon","heroicons_solid:magnifying-glass"),a(2),l("maxLength",30),a(3),u(n.tagsEditMode?-1:8),a(),u(n.tagsEditMode?9:-1),a(2),u(n.tagsEditMode?-1:11),a(),u(n.tagsEditMode?12:-1),a(),u(n.shouldShowCreateTagButton(e.value)?13:-1)}}function xi(t,c){t&1&&(m(0,"mat-icon",65),o(1,"span",66),p(2,"Low"),s()),t&2&&l("svgIcon","heroicons_mini:arrow-long-down")}function Ti(t,c){t&1&&(m(0,"mat-icon",65),o(1,"span",66),p(2,"Normal"),s()),t&2&&l("svgIcon","heroicons_solid:minus")}function yi(t,c){t&1&&(m(0,"mat-icon",65),o(1,"span",66),p(2,"High"),s()),t&2&&l("svgIcon","heroicons_mini:arrow-long-up")}function bi(t,c){if(t&1&&(p(0),z(1,"date")),t&2){let e=_();M(" ",W(1,1,e.task.dueDate,"longDate")," ")}}function wi(t,c){t&1&&p(0," Not set ")}var St=(()=>{class t{constructor(e,n,i,r,d,C,w,Mt,Ft,Et){this._activatedRoute=e,this._changeDetectorRef=n,this._formBuilder=i,this._fuseConfirmationService=r,this._renderer2=d,this._router=C,this._tasksListComponent=w,this._tasksService=Mt,this._overlay=Ft,this._viewContainerRef=Et,this.tagsEditMode=!1,this._unsubscribeAll=new H}ngOnInit(){this._tasksListComponent.matDrawer.open(),this.taskForm=this._formBuilder.group({id:[""],type:[""],title:[""],notes:[""],completed:[!1],dueDate:[null],priority:[0],tags:[[]],order:[0]}),this._tasksService.tags$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this._changeDetectorRef.markForCheck()}),this._tasksService.task$.pipe(x(this._unsubscribeAll)).subscribe(e=>{this._tasksListComponent.matDrawer.open(),this.task=e,this.taskForm.patchValue(e,{emitEvent:!1}),this._changeDetectorRef.markForCheck()}),this.taskForm.valueChanges.pipe(E(e=>{this.task=Pe(this.task,e)}),le(300),x(this._unsubscribeAll)).subscribe(e=>{this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}),this._router.events.pipe(x(this._unsubscribeAll),S(e=>e instanceof Se)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngAfterViewInit(){this._tasksListComponent.matDrawer.openedChange.pipe(x(this._unsubscribeAll),S(e=>e)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._tasksListComponent.matDrawer.close()}toggleCompleted(){let e=this.taskForm.get("completed");e.setValue(!e.value)}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});let e=new Fe(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){let n=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(i=>i.title.toLowerCase().includes(n))}filterTagsInputKeyDown(e){if(e.key!=="Enter")return;if(this.filteredTags.length===0){this.createTag(e.target.value),e.target.value="";return}let n=this.filteredTags[0];this.task.tags.find(r=>r===n.id)?this.deleteTagFromTask(n):this.addTagToTask(n)}createTag(e){let n={title:e};this._tasksService.createTag(n).subscribe(i=>{this.addTagToTask(i)})}updateTagTitle(e,n){e.title=n.target.value,this._tasksService.updateTag(e.id,e).pipe(le(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._tasksService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToTask(e){this.task.tags.unshift(e.id),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}deleteTagFromTask(e){this.task.tags.splice(this.task.tags.findIndex(n=>n===e.id),1),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}toggleTaskTag(e){this.task.tags.includes(e.id)?this.deleteTagFromTask(e):this.addTagToTask(e)}shouldShowCreateTagButton(e){return!(e===""||this.tags.findIndex(n=>n.title.toLowerCase()===e.toLowerCase())>-1)}setTaskPriority(e){this.taskForm.get("priority").setValue(e)}isOverdue(){return ce.fromISO(this.task.dueDate).startOf("day")<ce.now().startOf("day")}deleteTask(){this._fuseConfirmationService.open({title:"Delete task",message:"Are you sure you want to delete this task? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(n=>{if(n==="confirmed"){let i=this.task.id,r=this.tasks.findIndex(w=>w.id===i),d=r+(r===this.tasks.length-1?-1:1),C=this.tasks.length===1&&this.tasks[0].id===i?null:this.tasks[d].id;this._tasksService.deleteTask(i).subscribe(w=>{w&&(C?this._router.navigate(["../",C],{relativeTo:this._activatedRoute}):this._router.navigate(["../"],{relativeTo:this._activatedRoute}))}),this._changeDetectorRef.markForCheck()}})}trackByFn(e,n){return n.id||e}static{this.\u0275fac=function(n){return new(n||t)(h(Z),h(X),h(Ze),h(je),h(fe),h(Q),h(se),h(F),h(Ee),h(he))}}static{this.\u0275cmp=R({type:t,selectors:[["tasks-details"]],viewQuery:function(n,i){if(n&1&&(P(ti,5),P(ii,5),P(ni,5)),n&2){let r;O(r=j())&&(i._tagsPanelOrigin=r.first),O(r=j())&&(i._tagsPanel=r.first),O(r=j())&&(i._titleField=r.first)}},standalone:!0,features:[B],decls:82,vars:53,consts:[["moreMenu","matMenu"],["titleField",""],["tagsPanelOrigin",""],["tagsPanel",""],["priorityMenu","matMenu"],["dueDatePicker",""],["newTagInput",""],[1,"flex","flex-auto"],[1,"flex","flex-auto","flex-col","overflow-y-auto","p-6","pt-10","sm:p-8","sm:pt-10",3,"formGroup"],[1,"-ml-4","-mt-3","flex","items-center","justify-between"],["mat-button","",1,"pl-3.5","pr-4",3,"click"],[1,"flex","items-center","justify-center"],[1,"flex","items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"routerLink"],[1,"mb-8","mt-6"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","spellcheck"],[1,"mt-8"],[1,"mb-1.5","font-medium"],[1,"-m-1.5","flex","flex-wrap","items-center"],[1,"m-1.5","flex","cursor-pointer","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300",3,"click"],[1,"mt-8","flex","flex-wrap","items-center"],[1,"font-medium"],[1,"mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"ngClass","matMenuTriggerFor"],["mat-menu-item","",3,"click","ngClass"],[1,"inline-flex","w-full","min-w-30","items-center","justify-between","leading-5"],[1,"mr-0","text-green-600","icon-size-4","dark:text-green-500",3,"svgIcon"],[1,"mr-0","text-gray-600","icon-size-4","dark:text-gray-500",3,"svgIcon"],[1,"mr-0","text-red-600","icon-size-4","dark:text-red-500",3,"svgIcon"],[1,"ml-6"],[1,"relative","mt-1.5","flex","cursor-pointer","items-center","rounded-full","px-4","leading-9",3,"click","ngClass"],[1,"text-current","icon-size-5",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","pointer-events-none","invisible","absolute","inset-0","-mt-2.5","opacity-0",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",1,"",3,"color"],[1,"ml-2","font-semibold"],[1,"text-primary",3,"svgIcon"],[1,"m-1.5","flex","items-center","justify-center","rounded-full","bg-gray-100","px-4","leading-9","text-gray-500","dark:bg-gray-700","dark:text-gray-300"],[1,"whitespace-nowrap","text-md","font-medium"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-1.5","whitespace-nowrap","text-md","font-medium"],[1,"bg-card","w-60","rounded","border","shadow-md"],[1,"m-3","mr-2","flex","items-center"],[1,"ml-2"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","border-0","py-1",3,"input","keydown","maxLength"],["mat-icon-button","",1,"ml-1",3,"click"],[1,"flex","max-h-64","flex-col","overflow-y-auto","border-t","py-2"],[1,"space-y-2","py-2"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover"],["matRipple","",1,"flex","h-10","min-h-10","cursor-pointer","items-center","pl-1","pr-4","hover:bg-hover",3,"click"],[1,"pointer-events-none","flex","h-10","min-h-10","items-center",3,"checked","color","disableRipple"],[1,"ml-1"],[1,"fuse-mat-dense","mx-4","w-full",3,"subscriptSizing"],["matInput","",3,"input","value"],["mat-icon-button","","matSuffix","",3,"click"],[1,"ml-2","icon-size-5",3,"svgIcon"],["matRipple","",1,"-ml-0.5","flex","h-10","min-h-10","cursor-pointer","items-center","pl-4","pr-3","leading-none","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"text-current","icon-size-4",3,"svgIcon"],[1,"ml-2","mr-1","text-md","font-medium"]],template:function(n,i){if(n&1){let r=b();o(0,"div",7)(1,"form",8)(2,"div",9)(3,"button",10),f("click",function(){return k(r),g(i.toggleCompleted())}),v(4,si,4,1,"div",11)(5,li,4,1,"div",11),s(),o(6,"div",12)(7,"button",13),m(8,"mat-icon",14),s(),o(9,"mat-menu",null,0)(11,"button",15),f("click",function(){return k(r),g(i.deleteTask())}),m(12,"mat-icon",14),o(13,"span"),p(14),s()()(),o(15,"a",16),m(16,"mat-icon",14),s()()(),m(17,"mat-divider",17),o(18,"div")(19,"mat-form-field",18)(20,"mat-label"),p(21),s(),m(22,"textarea",19,1),s()(),o(24,"div",20)(25,"div",21),p(26,"Tags"),s(),o(27,"div",22),v(28,mi,3,4),o(29,"div",23,2),f("click",function(){return k(r),g(i.openTagsPanel())}),v(31,pi,3,1)(32,di,3,1)(33,Ci,14,7,"ng-template",null,3,ye),s()()(),o(35,"div",24)(36,"div")(37,"div",25),p(38,"Priority"),s(),o(39,"div",26),v(40,xi,3,1)(41,Ti,3,1)(42,yi,3,1),s(),o(43,"mat-menu",null,4)(45,"button",27),f("click",function(){return k(r),g(i.setTaskPriority(0))}),o(46,"span",28)(47,"span",25),p(48,"Low"),s(),m(49,"mat-icon",29),s()(),o(50,"button",27),f("click",function(){return k(r),g(i.setTaskPriority(1))}),o(51,"span",28)(52,"span",25),p(53,"Normal"),s(),m(54,"mat-icon",30),s()(),o(55,"button",27),f("click",function(){return k(r),g(i.setTaskPriority(2))}),o(56,"span",28)(57,"span",25),p(58,"High"),s(),m(59,"mat-icon",31),s()()()(),o(60,"div",32)(61,"div",25),p(62,"Due date"),s(),o(63,"div",33),f("click",function(){k(r);let C=I(71);return g(C.open())}),m(64,"mat-icon",34),o(65,"span",35),v(66,bi,2,4)(67,wi,1,0),s(),o(68,"mat-form-field",36),m(69,"input",37),o(70,"mat-datepicker",null,5)(72,"mat-datepicker-actions")(73,"button",38),f("click",function(){return k(r),g(i.taskForm.get("dueDate").setValue(null))}),p(74," Clear "),s(),o(75,"button",39),p(76," Select "),s()()()()()()(),o(77,"div",20)(78,"mat-form-field",18)(79,"mat-label"),p(80,"Notes"),s(),m(81,"textarea",19),s()()()()}if(n&2){let r=I(10),d=I(44),C=I(71);a(),l("formGroup",i.taskForm),a(3),u(i.taskForm.get("completed").value?-1:4),a(),u(i.taskForm.get("completed").value?5:-1),a(2),l("matMenuTriggerFor",r),a(),l("svgIcon","heroicons_outline:ellipsis-vertical"),a(4),l("svgIcon","heroicons_outline:trash"),a(2),M("Delete ",i.task.type==="task"?"task":"section",""),a(),l("routerLink",Ce(38,ai)),a(),l("svgIcon","heroicons_outline:x-mark"),a(3),l("subscriptSizing","dynamic"),a(2),$(i.task.type==="task"?"Task title":"Section title"),a(),l("formControlName","title")("spellcheck",!1),a(6),u(i.task.tags.length?28:-1),a(3),u(i.task.tags.length?31:-1),a(),u(i.task.tags.length?-1:32),a(7),l("ngClass",q(39,oi,i.task.priority===0,i.task.priority===1,i.task.priority===2))("matMenuTriggerFor",d),a(),u(i.task.priority===0?40:-1),a(),u(i.task.priority===1?41:-1),a(),u(i.task.priority===2?42:-1),a(3),l("ngClass",N(43,pe,i.task.priority===0)),a(4),l("svgIcon","heroicons_mini:arrow-long-down"),a(),l("ngClass",N(45,pe,i.task.priority===1)),a(4),l("svgIcon","heroicons_solid:minus"),a(),l("ngClass",N(47,pe,i.task.priority===2)),a(4),l("svgIcon","heroicons_mini:arrow-long-up"),a(4),l("ngClass",q(49,ri,!i.task.dueDate,i.task.dueDate&&!i.isOverdue(),i.task.dueDate&&i.isOverdue())),a(),l("svgIcon","heroicons_solid:calendar"),a(2),u(i.task.dueDate?66:-1),a(),u(i.task.dueDate?-1:67),a(),l("subscriptSizing","dynamic"),a(),l("formControlName","dueDate")("matDatepicker",C),a(6),l("color","primary"),a(3),l("subscriptSizing","dynamic"),a(3),l("formControlName","notes")("spellcheck",!1)}},dependencies:[et,Xe,Ue,Ge,We,tt,Ye,Je,ae,ie,Oe,ne,re,oe,He,Ke,Qe,qe,te,st,rt,Ae,Ve,Re,Le,ot,at,it,nt,Me,Ie,ct,lt,Y,vt,_t,kt,ht,ft,gt,Ct,J],encapsulation:2,changeDetection:0})}}return t})();var It=(()=>{class t{constructor(){}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=R({type:t,selectors:[["tasks"]],standalone:!0,features:[B],decls:1,vars:0,template:function(n,i){n&1&&m(0,"router-outlet")},dependencies:[ee],encapsulation:2,changeDetection:0})}}return t})();var Di=(t,c)=>{let e=K(F),n=K(Q);return e.getTaskById(t.paramMap.get("id")).pipe(_e(i=>{console.error(i);let r=c.url.split("/").slice(0,-1).join("/");return n.navigateByUrl(r),G(i)}))},Si=(t,c,e,n)=>{let i=n.root;for(;i.firstChild;)i=i.firstChild;return!n.url.includes("/tasks")||i.paramMap.get("id")?!0:t.closeDrawer().then(()=>!0)},In=[{path:"",component:It,resolve:{tags:()=>K(F).getTags()},children:[{path:"",component:se,resolve:{tasks:()=>K(F).getTasks()},children:[{path:":id",component:St,resolve:{task:Di},canDeactivate:[Si]}]}]}];export{In as default};
